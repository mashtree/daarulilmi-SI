$(document).on("click",".rekam",function(a){a.preventDefault(),rekam()}),$(document).on("click",".save",function(){var a=$("#rekam"),l=a.find('[name="name"]').val();console.log(l),$.ajax({url:"kar/create_kar",method:"POST",data:a.serialize()}).success(function(t){console.log($.parseJSON(t).success),a.parents(".bootbox").modal("hide"),1==$.parseJSON(t).success?(Message.show("<b>Rekam data "+l+" berhasil! </b>"),setTimeout(function(){window.location.reload(1)},5e3)):Message.show("<b style='color:red'>Rekam data "+l+" gagal! periksa kembali isian! </b>")})}),$(function(){var a=$("#t_table").bootgrid({formatters:{open:function(a,l){return'<button type="button" class="btn btn-default btn-xs command-open" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="Detil"><span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span></button> '},commands:function(a,l){var t='<div class="btn-group" role="group" aria-label="...">';return t+='<button type="button" class="btn btn-default btn-xs command-edit" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="Ubah"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></button> ',t+='<button type="button" class="btn btn-default btn-xs command-delete" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="Hapus" class="confirm" dilink="kar/remove_kar/'+l.id+'"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button> ',"guru"!=l.jabatan&&(t+='<button type="button" class="btn btn-default btn-xs command-guru" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="Rekam sebagai guru" dilink="kar/update_kar_guru/'+l.id+'"><span class="glyphicon glyphicon-education" aria-hidden="true"></span></button> '),t+="0"==l.aktif?'<button type="button" class="btn btn-default btn-xs command-aktif" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="tidak aktif" dilink="kar/kar_aktif/'+l.id+'" diaktif='+l.aktif+'><span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span></button> ':'<button type="button" class="btn btn-default btn-xs command-aktif" data-row-id="'+l.id+'"  data-toggle="tooltip" data-placement="right" title="aktif" dilink="kar/kar_aktif/'+l.id+'"  diaktif='+l.aktif+'><span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span></button> ',t+="</div>"}}}).on("loaded.rs.jquery.bootgrid",function(){a.find(".command-edit").on("click",function(a){a.preventDefault(),edit($(this))}).end().find(".command-delete").on("click",function(a){var l=$(this).attr("dilink");console.log(l),a.preventDefault(),bootbox.confirm("Anda yakin akan menghapus data ini?",function(a){a&&(document.location.href=l)})}).end().find(".command-guru").on("click",function(a){var l=$(this).attr("dilink");console.log(l),a.preventDefault(),bootbox.confirm("Anda yakin akan mencatat karyawan ini dalam jabatan Guru?",function(a){a&&(document.location.href=l)})}).end().find(".command-open").on("click",function(a){a.preventDefault(),open($(this))}).end().find(".command-aktif").on("click",function(a){var l=$(this).attr("diaktif");console.log(l);var t=$(this).attr("dilink");console.log(t);var i="";a.preventDefault(),i=0==l?"Karyawan ini akan diaktifkan?":"Karyawan ini akan dinonaktifkan?",bootbox.confirm(i,function(a){a&&(document.location.href=t)})})});$('[data-toggle="tooltip"]').tooltip()}),$(document).on("click",".save_edit",function(){var a=$("#ubah"),l=a.find('[name="id"]').val(),t=a.find('[name="name"]').val();$.ajax({url:"kar/update_kar/"+l,method:"POST",data:a.serialize()}).success(function(l){console.log($.parseJSON(l)),a.parents(".bootbox").modal("hide"),1==$.parseJSON(l).success?(Message.show("<b>Ubah data "+t+" berhasil! </b>"),setTimeout(function(){window.location.reload(1)},5e3)):Message.show("<b style='color:red'>Ubah data "+t+" gagal! periksa kembali isian! </b>")})});var rekam=function(){bootbox.dialog({title:"Rekam Karyawan",message:'<div class="row" id="modal">  <div class="col-md-12"> <form class="form-horizontal" id="rekam" enctype="multipart/form-data"> <div class="form-group"> <label class="col-md-4 control-label" for="name">Name</label> <div class="col-md-6"> <input id="name" name="name" type="text" placeholder="Nama Karyawan" class="form-control input-md"> </div></div> <div class="form-group"><label class="col-md-4 control-label" for="tmp_lahir">Tempat Lahir</label> <div class="col-md-6"> <input id="tmp_lahir" name="tmp_lahir" type="text" placeholder="Tempat Lahir" class="form-control input-md"> </div></div><div class="form-group"><label class="col-md-4 control-label" for="tgl_lahir">Tanggal Lahir</label> <div class="col-md-4"> <input id="tgl_lahir" name="tgl_lahir" type="text" placeholder="Tanggal Lahir" class="form-control input-md" readonly> </div></div><div class="form-group"><label class="col-md-4 control-label" for="tgl_lahir">Tanggal Lahir</label> <div class="col-md-8"> <textarea id="alamat" name="alamat" placeholder="Alamat" class="form-control input-md" rows="6"></textarea> </div></div><div class="form-group"><label class="col-md-4 control-label" for="sebagai">Jabatan</label> <div class="col-md-6"> <select id="sebagai" name="sebagai" class="form-control input-md"></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="foto">File Foto</label> <div class="col-md-6"> <input id="foto" name="foto" type="file" placeholder="Foto" class="form-control input-md"> </div></div><div class="form-group"><label class="col-md-4 control-label" for="sebagai"></label> <div class="col-md-6"> <button type="button" class="btn btn-default save">Save</button></div></div></form> </div>  </div>',onEscape:!0}),$.get("kar/get_jabatan",function(a){var a=$.parseJSON(a);$.each(a,function(a,l){$("#sebagai").append("<option value="+l.id+">"+l.jab+"</option>")})}),$("#tgl_lahir").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,viewSelect:"day"})},edit=function(a){var l,t,i,o,e,s=a.data("row-id"),d="kar/get_by_id/"+s;$.ajax({url:d,method:"POST"}).success(function(a){var s=$.parseJSON(a)[0];l=s.nm_karyawan,t=s.tmp_lahir,i=s.tgl_lahir,o=s.alamat,e=s.sebagai,bootbox.dialog({title:"Ubah Data Karyawan",message:'<div class="row">  <div class="col-md-12"> <form class="form-horizontal" id="ubah" enctype="multipart/form-data"> <div class="form-group"><div class="col-md-6"> <input id="id" name="id" type="hidden" class="form-control input-md" value="'+s.id+'"> </div></div><div class="form-group"> <label class="col-md-4 control-label" for="name">Name</label> <div class="col-md-6"> <input id="name" name="name" type="text" placeholder="Nama Karyawan" class="form-control input-md" value="'+l+'"> </div></div> <div class="form-group"><label class="col-md-4 control-label" for="tmp_lahir">Tempat Lahir</label> <div class="col-md-6"> <input id="tmp_lahir" name="tmp_lahir" type="text" placeholder="Tempat Lahir" class="form-control input-md" value="'+t+'"> </div></div><div class="form-group"><label class="col-md-4 control-label" for="tgl_lahir">Tanggal Lahir</label> <div class="col-md-4"> <input id="tgl_lahir" name="tgl_lahir" type="text" placeholder="Tanggal Lahir" class="form-control input-md" readonly  value="'+i+'"> </div></div><div class="form-group"><label class="col-md-4 control-label" for="tgl_lahir">Tanggal Lahir</label> <div class="col-md-8"> <textarea id="alamat" name="alamat" placeholder="Alamat" class="form-control input-md" rows="6">'+o+'</textarea> </div></div><div class="form-group"><label class="col-md-4 control-label" for="sebagai">Jabatan</label> <div class="col-md-6"> <select id="sebagai" name="sebagai" class="form-control input-md"></select></div></div><div class="form-group"><label class="col-md-4 control-label" for="foto">File Foto</label> <div class="col-md-6"> <input id="foto" name="foto" type="file" placeholder="Foto" class="form-control input-md"> </div></div><div class="form-group"><label class="col-md-4 control-label" for="submit"></label> <div class="col-md-4"><button type="button" class="btn btn-default save_edit">Save</button></div></div></form> </div>  </div>',onEscape:!0}),$.get("kar/get_jabatan",function(a){var a=$.parseJSON(a);$.each(a,function(a,l){var t="<option value="+l.id;e==l.id&&(t+=" selected"),t+=">"+l.jab+"</option>",$("#sebagai").append(t)})}),$("#tgl_lahir").datetimepicker({format:"yyyy-mm-dd",autoclose:!0,viewMode:"years"})})},open=function(a){var l=a.data("row-id"),t="kar/get_by_id/"+l;$.ajax({url:t,method:"POST"}).success(function(a){var t=$.parseJSON(a)[0],i="";2==t.sebagai&&(i='<div class="row">  <div class="col-md-3"></div> <div class="col-md-6"><a class="detgur" style="cursor:pointer" idkar='+l+" nmkar="+t.nm_karyawan+'><span>[data guru]</span></a></div><div class="col-md-3"></div></div>');var o='<div class="row">  <div class="col-md-3"></div> <div class="col-md-6"><img src="public/image/nopict.jpg" alt="..." class="img-thumbnail"></div><div class="col-md-3"></div></div>'+i+'<div class="row" style="margin-top:10px">  <div class="col-md-3"><b>nama</b></div> <div class="col-md-6">'+t.nm_karyawan+'</div></div><div class="row">  <div class="col-md-3"><b>no induk</b></div> <div class="col-md-6">'+t.no_induk+'</div></div><div class="row">  <div class="col-md-3"><b>tempat lahir</b></div> <div class="col-md-3">'+t.tmp_lahir+'</div><div class="col-md-3"><b>tanggal lahir</b></div> <div class="col-md-3">'+t.tgl_lahir+'</div></div><div class="row">  <div class="col-md-3"><b>alamat</b></div> <div class="col-md-6">'+t.alamat+'</div></div><div class="row">  <div class="col-md-3"><b>jabatan</b></div> <div class="col-md-6">'+t.jabatan+"</div></div>";bootbox.dialog({title:"Detil Karyawan",message:o,buttons:{success:{label:"OK",className:"btn-default",callback:function(){}}},onEscape:!0}),$(".detgur").on("click",function(a){a.preventDefault();var l=$(this).attr("idkar"),t=$(this).attr("nmkar");dataguru(l,t)})})},dataguru=function(a,l){$.ajax({url:"kar/get_detil_guru/"+a,method:"POST"}).success(function(a){var t,i,o,e,s=$.parseJSON(a);if(s.pendidikan.size>0){t='<ul class="list-group">';for(var d in s.pendidikan.data)t+='<li class="list-group-item">'+d.tingkat+" "+d.nm_lembaga+" "+d.thn_lulus+"</li>";t+="</ul>"}else t='<span style="text-align:center">DATA TIDAK DITEMUKAN</span>';if(s.pengalaman.size>0){i='<ul class="list-group">';for(var d in s.pengalaman.data)i+='<li class="list-group-item">'+d.lembaga+" "+d.thn_awal+" "+d.thn_akhir+" "+d.jabatan+"</li>";i+="</ul>"}else i='<span style="text-align:center">DATA TIDAK DITEMUKAN</span>';if(s.wali.size>0){o='<ul class="list-group">';for(var d in s.wali.data)o+='<li class="list-group-item">'+d.nm_kelas+"</li>";o+="</ul>"}else o='<span style="text-align:center">DATA TIDAK DITEMUKAN</span>';if(s.pengampu.size>0){e='<ul class="list-group">';for(var d in s.pengampu.data)e+='<li class="list-group-item">'+d.mapel+" "+d.nm_kelas+"</li>";e+="</ul>"}else e='<span style="text-align:center">DATA TIDAK DITEMUKAN</span>';var n='<div><!-- Nav tabs --><ul class="nav nav-tabs" role="tablist"><li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Penugasan</a></li><li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Profile</a></li></ul><!-- Tab panes --><div class="tab-content"><div role="tabpanel" class="tab-pane active" id="home"><div class="row"><div class="col-md-6"><h4>Wali Kelas :</h4><hr/></div><div class="col-md-6"><h4>Pengampu Mapel :</h4><hr/></div></div><div class="row"><div class="col-md-6">'+o+'</div><div class="col-md-6">'+e+'</div></div></div><div role="tabpanel" class="tab-pane" id="profile"><div class="row"><div class="col-md-6"><h4>Pendidikan :</h4><hr/></div><div class="col-md-6"><h4>Pengalaman Kerja :</h4><hr/></div></div><div class="row"><div class="col-md-6">'+t+'</div><div class="col-md-6">'+i+"</div></div></div></div></div>";bootbox.dialog({title:"Data Guru : "+l,message:n,size:"large",onEscape:!0,button:{success:{label:"OK",className:"btn-default",callback:function(){}}}})})};